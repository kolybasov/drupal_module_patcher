// Generated by CoffeeScript 1.9.1
$('form').submit(function(e) {
  var button, enctype, formData, method, module, patch, url;
  e.preventDefault();
  url = $(this).attr('action');
  method = $(this).attr('method');
  enctype = $(this).attr('enctype');
  button = $('input[type=submit]', this);
  button.val('Processing...').attr('disabled', 'disabled');
  formData = new FormData();
  module = $('#module')[0].files[0];
  patch = $('#patch')[0].files[0];
  formData.append('module', module);
  formData.append('patch', patch);
  $.ajax({
    url: url,
    type: method,
    contentType: enctype,
    processData: false,
    data: formData,
    success: function(data) {
      $("#output").text(data.output);
      return $('.btn-success').attr('href', "/download/" + data.file).removeClass('hidden');
    },
    error: function() {
      return $("#output").html('<h1>Something went wrong!</h1>');
    },
    complete: function() {
      return button.val('Patch!').removeAttr('disabled');
    }
  });
  return this;
});
